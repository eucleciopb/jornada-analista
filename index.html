<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portal de Treinamentos</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>

<body class="bg">

<main class="center-wrapper">
  <div class="login-card">
    <div class="logo-box">GP</div>

    <h2>Bem-vindo</h2>
    <p class="hint">Selecione seu nome para acessar o sistema</p>

    <div class="form-group">
      <label for="usuario">Usuário</label>
      <select id="usuario">
        <option value="" disabled selected>Selecione...</option>
        <option>Emerson</option>
        <option>Euclecio</option>
        <option>Joice</option>
        <option>Michel</option>
        <option>Muller</option>
        <option>Pedro</option>
        <option>Ricardo</option>
        <option>Robert</option>
        <option>Rodrigo</option>
        <option>Rosilene</option>
      </select>
    </div>

    <button id="btnEntrar" class="btn-primary" type="button">Entrar</button>

    <button id="btnLogin" class="btn-secondary full-width" type="button">
      Ir para Login
    </button>

    <p id="msg" class="msg"></p>
  </div>
</main>

<!-- Firebase + Firestore (CDN) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

  // ✅ SUA CONFIG (ok para front-end)
  const firebaseConfig = {
    apiKey: "AIzaSyDN7RF9UiFyDAFXsPsVQwSRONJB0t1Xpqg",
    authDomain: "jornada-portal.firebaseapp.com",
    projectId: "jornada-portal",
    storageBucket: "jornada-portal.firebasestorage.app",
    messagingSenderId: "669362296644",
    appId: "1:669362296644:web:f590d9834a8e4e60012911"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const usuarioSelect = document.getElementById("usuario");
  const btnEntrar = document.getElementById("btnEntrar");
  const btnLogin = document.getElementById("btnLogin");
  const msg = document.getElementById("msg");

  function setMsg(text, ok = false){
    msg.textContent = text || "";
    msg.style.color = ok ? "#22c55e" : "#ef4444";
  }

  btnEntrar.onclick = async () => {
    const usuario = (usuarioSelect.value || "").trim();

    if (!usuario) {
      setMsg("Selecione um usuário.");
      return;
    }

    btnEntrar.disabled = true;
    btnEntrar.style.opacity = ".7";
    setMsg("Entrando...", true);

    try {
      // 1) salva no localStorage
      localStorage.setItem("usuarioLogado", usuario);

      // 2) grava log no Firestore (auditoria)
      // coleção sugerida: acessos
      await addDoc(collection(db, "acessos"), {
        usuario,
        origem: "index.html",
        evento: "LOGIN_SEM_AUTH",
        criadoEm: serverTimestamp(),
        userAgent: navigator.userAgent || null
      });

      // 3) redireciona
      // ✅ TROQUE AQUI se seu menu estiver em outro caminho
      // Exemplo pela sua estrutura: "html menus/menu.html"
      window.location.href = "html menus/menu.html";
      // Se o seu menu for na raiz: window.location.href = "menu.html";

    } catch (e) {
      console.error(e);
      setMsg("Falha ao gravar no Firebase. Verifique regras do Firestore.");
      btnEntrar.disabled = false;
      btnEntrar.style.opacity = "1";
    }
  };

  btnLogin.onclick = () => {
    window.location.href = "login.html";
  };
</script>

<style>
/* Layout centralizado */
.center-wrapper{
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.login-card{
  width:360px;
  padding:30px;
  border-radius:20px;
  background:rgba(23,25,29,.85);
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 20px 40px rgba(0,0,0,.4);
  text-align:center;
}

.logo-box{
  width:70px;
  height:70px;
  margin:0 auto 20px auto;
  border-radius:18px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:22px;
  color:#fff;
  background:linear-gradient(135deg,#d91b2e,#ff3b3b);
}

.form-group{
  margin-top:20px;
  text-align:left;
}

.form-group select{
  width:100%;
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.05);
  color:#fff;
  margin-top:6px;
}

.btn-primary{
  width:100%;
  margin-top:20px;
  padding:12px;
  border:none;
  border-radius:14px;
  font-weight:800;
  background:linear-gradient(135deg,#d91b2e,#ff3b3b);
  color:#fff;
  cursor:pointer;
}

.btn-secondary{
  margin-top:12px;
  padding:10px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.04);
  color:#fff;
  cursor:pointer;
}

.full-width{
  width:100%;
}

.msg{
  margin-top:12px;
  font-size:12px;
}

.hint{
  font-size:13px;
  opacity:.7;
}
</style>

</body>
</html>